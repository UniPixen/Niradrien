<?php	_setView(__FILE__);	_setTitle($langArray['upload_theme']);	if (!check_login_bool()) {		$_SESSION['temp']['golink'] = '/upload';		refresh('/login');	}	if ($_SESSION['member']['author'] != 'true') {		refresh('/become-author');	}	if (!isset($_GET['category']) || is_numeric($_GET['category']) || is_null($_GET['category'])) {		$_GET['category'] = '';	}	$allCategories = $categoriesClass->getAllWithChildsByKeyword(0, " visible = 'true' ");	$categoryID = $categoriesClass->getIDByKeyword($_GET['category']);	if (!$categoryID || !array_key_exists($categoryID, $allCategories)) {		addErrorMessage($langArray['error_wrong_category'], '', 'error');		abr('hideForm', 'true');	}	else {		if (!isset($_POST['category'])) {			$_POST['category'] = 0;		}		$categoriesSelect = $categoriesClass->generateSelect($allCategories, $_POST['category'], $categoryID);		abr('categoriesSelect', $categoriesSelect);		require_once ROOT_PATH . '/applications/attributes/modeles/attributes.class.php';		$attributesClass = new attributes();		$attributes = $attributesClass->getAllWithCategories(" visible = 'true' AND categories LIKE '%," . (int)$categoryID . ",%' ");		abr('attributes', $attributes);		// Enregistrer le produit		if (isset($_POST['upload'])) {			require_once ROOT_PATH . '/applications/product/modeles/product.class.php';			$productClass = new product();			$s = $productClass->add();			if ($s === true) {				refresh('/author', $langArray['complete_upload_product'], 'complete');			}			else {				$message = '<ul>';				foreach($s as $e) {					$message .= '<li>' . $e . '</li>';				}				$message .= '</ul>';				addErrorMessage($message, '', 'error');			}		}		else {			$_POST['name'] = '';			$_POST['description'] = '';			$_POST['description_en'] = '';			$_POST['demo_url'] = '';			$_POST['tags'] = '';			$_POST['comments_to_reviewer'] = '';			$_POST['suggested_price'] = '';			if (!isset($_SESSION['temp']['uploaded_files'])) {				$_SESSION['temp']['uploaded_files'] = '';			}		}		$fileTypes = '';		foreach($config['upload_ext'] as $ext) {			if ($fileTypes != '') {				$fileTypes .= ';';			}			$fileTypes .= '*.' . $ext;		}		abr('fileTypes', $fileTypes);		abr('sessID', session_id());	}	// Pourcentage de reversement	$member = $membersClass->get($_SESSION['member']['member_id']);	require_once ROOT_PATH . '/applications/percents/modeles/percents.class.php';	$percentsClass = new percents();	$percent = $percentsClass->getPercentRow($member);	abr('commission', $percent);?>